$(".signup input, .login input, .searchBox input").focus(function(){var height=$("body").css('height');$("body").css('height',height)});$(".searchBox input").focus(function(){var height=$("#spotMenu").css('height');$("#spotMenu").css('height',height)});$("li.category").hover(function(){$(".categoryDropdown").slideDown(300)},function(){$(".categoryDropdown").slideUp(300)});$(".skateboard").hover(function(){$(".skateboarder").addClass("line-growth")},function(){$(".skateboarder").removeClass("line-growth")});$(".bmx").hover(function(){$(".bmx-rider").addClass("line-growth")},function(){$(".bmx-rider").removeClass("line-growth")});$(".trail-bike").hover(function(){$(".trail-rider").addClass("line-growth")},function(){$(".trail-rider").removeClass("line-growth")})
$(".login input").focus(function(){$("#loginBtn").removeClass('toggle')});$(".login input").focusout(function(){$("#loginBtn").addClass('toggle')});$(".usrTab").click(function(){$("#logoutBtn").toggleClass('toggle')});$(".openbtn, .closebtn").click(function(){$("#spotMenu").toggleClass('toggle');$(".top-bar").toggleClass('toggle')});$(".openbtn, .closebtn").click(function(){$(".openbtn").toggleClass("invisible");$(".closebtn").toggleClass("visible")});$("#mtb").click(function(){history.replaceState("","page 1","spots.html?locations=mtb");if($("#skatepark").hasClass("white")){$("#skatepark").removeClass("white");$("#mtb").addClass("white")}else{$("#mtb").addClass("white")}});$("#skatepark").click(function(){history.replaceState("","page 1","spots.html?locations=skatepark");if($("#mtb").hasClass("white")){$("#mtb").removeClass("white");$("#skatepark").addClass("white")}else{$("#skatepark").addClass("white")}});$(".driving").click(function(){$("#selected").removeAttr("id");$(".driving").attr("id","selected")});$(".transit").click(function(){$("#selected").removeAttr("id");$(".transit").attr("id","selected")});$(".bicycling").click(function(){$("#selected").removeAttr("id");$(".bicycling").attr("id","selected")});$(".walking").click(function(){$("#selected").removeAttr("id");$(".walking").attr("id","selected")});$("#places:empty").html('<img class="arrows" src="img/arrows.png"><div class="err-box" style="height:50px"><div class="msg">Select a radius and an option to find locations</div></div>');$('#places').on('scroll',function(){if($(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight){$("#addSpotbtn").fadeOut('fast')}else{$("#addSpotbtn").fadeIn('fast')}});$(document).on({mouseenter:function(){let $parent=$(this).closest(".places-tab");$parent.find(".tab-footer").slideDown(200)},mouseleave:function(){let $parent=$(this).closest(".places-tab");$parent.find(".tab-footer").slideUp(200)}},".places-tab");$(document).on("click",".moreBtn, .lessBtn",function(e){let $parent=$(this).closest(".places-tab");$parent.find(".moreBtn, .lessBtn").toggleClass("hide");$parent.find('.result-review, .result-info').toggleClass('toggle')});$(document).on("click",".shrBtn",function(e){let $parent=$(this).closest(".places-tab");$parent.find(".tab-footer .social").toggleClass("toggle");$parent.find(".tab-footer .actions").toggleClass("toggle")});$(document).on("click",".tab-footer .social a",function(e){let $parent=$(this).closest(".places-tab");$parent.find(".tab-footer .social").toggleClass("toggle");$parent.find(".tab-footer .actions").toggleClass("toggle")});var map,infoWindow;var marker;var markers=[];var renderObjects=[];var searches=[];function initMap(){var directionsDisplayBorder=new google.maps.DirectionsRenderer({polylineOptions:{strokeColor:"#3379c3",strokeOpacity:1,strokeWeight:7}});var directionsDisplay=new google.maps.DirectionsRenderer({polylineOptions:{strokeColor:"#3bb3fc",strokeOpacity:1,strokeWeight:4}});map=new google.maps.Map(document.getElementById('map'),{center:{lat:-34.397,lng:150.644},zoom:13,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.BOTTOM_CENTER},zoomControl:!1,scaleControl:!0,streetViewControl:!1,fullscreenControl:!1,styles:[{"elementType":"geometry","stylers":[{"color":"#242f3e"}]},{"elementType":"labels.text.fill","stylers":[{"color":"#746855"}]},{"elementType":"labels.text.stroke","stylers":[{"color":"#242f3e"}]},{"featureType":"administrative","elementType":"geometry","stylers":[{"visibility":"off"}]},{"featureType":"administrative.land_parcel","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"administrative.locality","elementType":"labels.text.fill","stylers":[{"color":"#d59563"}]},{"featureType":"poi","stylers":[{"visibility":"off"}]},{"featureType":"poi","elementType":"labels.text.fill","stylers":[{"color":"#d59563"}]},{"featureType":"poi.park","elementType":"geometry","stylers":[{"color":"#263c3f"}]},{"featureType":"poi.park","elementType":"labels.text.fill","stylers":[{"color":"#6b9a76"}]},{"featureType":"road","elementType":"geometry","stylers":[{"color":"#38414e"}]},{"featureType":"road","elementType":"geometry.stroke","stylers":[{"color":"#212a37"}]},{"featureType":"road","elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"featureType":"road","elementType":"labels.text.fill","stylers":[{"color":"#9ca5b3"}]},{"featureType":"road.highway","elementType":"geometry","stylers":[{"color":"#746855"}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#1f2835"}]},{"featureType":"road.highway","elementType":"labels.text.fill","stylers":[{"color":"#f3d19c"}]},{"featureType":"road.local","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"transit","stylers":[{"visibility":"off"}]},{"featureType":"transit","elementType":"geometry","stylers":[{"color":"#2f3948"}]},{"featureType":"transit.station","elementType":"labels.text.fill","stylers":[{"color":"#d59563"}]},{"featureType":"water","elementType":"geometry","stylers":[{"color":"#17263c"}]},{"featureType":"water","elementType":"labels.text.fill","stylers":[{"color":"#515c6d"}]},{"featureType":"water","elementType":"labels.text.stroke","stylers":[{"color":"#17263c"}]}],});infoWindow=new google.maps.InfoWindow();var autocomplete=new google.maps.places.Autocomplete((document.getElementById("addressInput")),{types:["geocode"]});if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function success(position){var pos;document.getElementById("searchButton").onclick=searchLocations;function searchLocations(){var address=document.getElementById("addressInput").value;var geocoder=new google.maps.Geocoder();geocoder.geocode({'address':address},function(results,status){if(status==='OK'){clearSearches();pos={lat:results[0].geometry.location.lat(),lng:results[0].geometry.location.lng()};var marker=new google.maps.Marker({map:map,position:results[0].geometry.location,title:'Searched location: '+address});map.setCenter(results[0].geometry.location);map.setZoom(10);searches.push(marker)}else{alert('Geocode was not successful for the following reason: '+status)}})}
document.getElementById("geo").onclick=function(){clearSearches();pos={lat:position.coords.latitude,lng:position.coords.longitude};var marker=new google.maps.Marker({position:pos,map:map,title:'You\'re here',icon:'./img/icons/mapPin3.png'});infoWindow.setPosition(pos);map.setCenter(pos)};pos={lat:position.coords.latitude,lng:position.coords.longitude};var marker=new google.maps.Marker({position:pos,map:map,title:'You\'re here',icon:'./img/icons/mapPin3.png'});infowindow=new google.maps.InfoWindow();var service=new google.maps.places.PlacesService(map);infoWindow.setPosition(pos);map.setCenter(pos);var radiusSelected;$("#radiusSelect").change(function(){radiusSelected=document.getElementById("radiusSelect").value/0.00062137});if(document.URL.indexOf("spots.html?locations=skatepark")>=0){$("#skatepark").addClass("white");$("#defaultRadius").prop("selected",!0).change();service.nearbySearch({location:pos,radius:radiusSelected,keyword:'skate park',},callback);service.nearbySearch({location:pos,radius:radiusSelected,keyword:'bmx park',},callback);$("#places .arrows, #places .err-box").css('display','none')}
var skateparks=document.getElementById('skatepark');skateparks.addEventListener("click",function(e){deleteMarkers();clearRenderObjects();service.nearbySearch({location:pos,radius:radiusSelected,keyword:'skate park',},callback);service.nearbySearch({location:pos,radius:radiusSelected,keyword:'bmx park',},callback);infoWindow.setPosition(pos);map.setCenter(pos);$("#places").html("");$("#matrix").html("")},!1);if(document.URL.indexOf("spots.html?locations=mtb")>=0){$("#mtb").addClass("white");$("#defaultRadius").prop("selected",!0).change();service.nearbySearch({location:pos,radius:radiusSelected,keyword:'mtb trail',},callback);service.nearbySearch({location:pos,radius:radiusSelected,keyword:'bmx track',},callback);service.nearbySearch({location:pos,radius:radiusSelected,keyword:'pump track',},callback);$("#places .arrows, #places .err-box").css('display','none')}
var mtbtrails=document.getElementById('mtb');mtbtrails.addEventListener("click",function(e){deleteMarkers();clearRenderObjects();service.nearbySearch({location:pos,radius:radiusSelected,keyword:'mtb trail',},callback);service.nearbySearch({location:pos,radius:radiusSelected,keyword:'bmx track',},callback);service.nearbySearch({location:pos,radius:radiusSelected,keyword:'pump track',},callback);infoWindow.setPosition(pos);map.setCenter(pos);$("#places").html("");$("#matrix").html("")},!1);function handleLocationError(browserHasGeolocation,infoWindow,pos){infoWindow.setPosition(pos);infoWindow.setContent(browserHasGeolocation?'Error: The Geolocation service failed.':'Error: Your browser doesn\'t support geolocation.');infoWindow.open(map)}
function callback(results,status){if(status===google.maps.places.PlacesServiceStatus.OK){for(var i=0;i<results.length;i++){createMarker(results[i])}}}
function setMapOnAll(map){for(var i=0;i<markers.length;i++){markers[i].setMap(map)}}
function setMapOnAllSearches(map){for(var i=0;i<searches.length;i++){searches[i].setMap(map)}}
function createMarker(place){var marker=new google.maps.Marker({map:map,position:place.geometry.location,animation:google.maps.Animation.DROP,icon:'./img/icons//mapPin.png',});var bounds=new google.maps.LatLngBounds();for(var i=0;i<markers.length;i++){if(markers[i].getVisible()){bounds.extend(markers[i].getPosition())}}
map.fitBounds(bounds);markers.push(marker);var service=new google.maps.places.PlacesService(map);var request={reference:place.reference};google.maps.event.addListener(marker,'mouseover',function(){service.getDetails(request,function(details,status){infowindow.setContent(['<strong>'+details.name+'</strong>',details.formatted_address,'Rating:&nbsp;'+'<strong>'+details.rating+'</strong>',].join("<br />"));infowindow.open(map,marker);google.maps.event.addListener(marker,'mouseout',function(){infowindow.close(map,marker)})})});setTimeout(function createCards(){service.getDetails(request,function(details,status){if(status!=='OK'){setTimeout(function(){createCards()},(1000*3))}
var placesList=document.getElementById('places');var review;var photo;if(typeof details.rs!=='undefined'||typeof forEach==!'undefined'){review='<p>No Reviews Available :P</p>'}else{review=(function(rs,fx){var list=document.createElement('div');rs.forEach(function(r){list.appendChild(fx(r))});return list.innerHTML}(details.reviews,function(r){var item=document.createElement('p');item.appendChild(document.createTextNode(r.text));return item}))}
if(typeof place.photos==='undefined'){var formatted_locaiton=String(place.geometry.location).replace(/[()]/g,'').replace(', ',',%20');photo='style="background-image: url(https://maps.googleapis.com/maps/api/streetview?parameters&size=638x640&fov=50&location='+formatted_locaiton+'&key=AIzaSyAf_ENrICAhe0xOw5G3iz_e4XzbFeXGSEU);"'}else{photo='style="background-image: url('+place.photos[0].getUrl({'maxWidth':1000})+');"'}
placesList.innerHTML+='<div class="places-tab"><param id="place_id" value="'+place.geometry.location+'"><div class="result-content"><div class="content-wrap"><div class="result-review"><div class="review">'+review+'</div></div><div class="result-info"><div class="result-heading"><h3>'+details.name+'</h3><h3>Rating: <span>'+details.rating+'</span> </h3><a href="'+details.url+'" target="_blank">Open in Google Maps</a></div></div></div><div class="result-image" '+photo+'></div></div><div class="tab-footer" style="display:none"><div class="social"><a class="facebookBtn" href="https://www.facebook.com/sharer/sharer.html?u=callumcolley.github.io/streetscene&quote=Check%20out%20this%20awesome%20spot%20at%20'+details.name+'" target="_blank"></a><a class="twitterBtn" href="https://twitter.com/intent/tweet?text=Check%20out%20this%20awesome%20spot%20at%20'+details.name+'%20@streetscene" target="_blank"></a><a class="pinterestBtn" href="https://www.pinterest.com/pin/create/button/?url=callumcolley.github.io/streetscene&media=&description=Check%20out%20this%20awesome%20spot%20at%20'+details.name+'" target="_blank"></a></div><div class="actions"><a class="tab-button shrBtn" role="button">SHARE</a><a class="tab-button moreBtn" role="button">LEARN MORE</a><a class="tab-button lessBtn hide" role="button">SHOW LESS</a></div></div></div>'})},100);var directionsService=new google.maps.DirectionsService();directionsDisplayBorder.setMap(map);directionsDisplayBorder.setOptions({suppressMarkers:!0,});directionsDisplay.setMap(map);directionsDisplay.setOptions({suppressMarkers:!0,});google.maps.event.addListener(marker,'click',function(){calculateAndDisplayRoute(directionsService,directionsDisplayBorder,directionsDisplay);renderObjects.push(directionsDisplayBorder);renderObjects.push(directionsDisplay);var service=new google.maps.DistanceMatrixService();var selectedMode=document.getElementById("selected").value;$("#matrix").html("");service.getDistanceMatrix({origins:[pos],destinations:[marker.getPosition()],travelMode:google.maps.TravelMode[selectedMode],unitSystem:google.maps.UnitSystem.IMPERIAL,avoidHighways:!1,avoidTolls:!1},function(response,status){if(status!==google.maps.DistanceMatrixStatus.OK){alert('Error was: '+status)}else{var origins=response.originAddresses;var destinations=response.destinationAddresses;for(var i=0;i<origins.length;i++){var results=response.rows[i].elements;for(var j=0;j<results.length;j++){var element=results[j];var distance=element.distance.text;var duration=element.duration.text;var from=origins[i];var to=destinations[j];var label=document.getElementById("matrix");label.innerHTML+='<div id="matrixLabel"><div class="head"><img src="img/icons/'+selectedMode+'.png"</img><strong>'+duration+'</strong></div><br><div style="padding-left:4px">'+distance+'</div></div>'}}}})});function calculateAndDisplayRoute(directionsService,directionsDisplayBorder,directionsDisplay,place){var selectedMode=document.getElementById("selected").value;directionsService.route({origin:pos,destination:marker.getPosition(),travelMode:google.maps.TravelMode[selectedMode]},function(response,status){if(status==='OK'){directionsDisplayBorder.setDirections(response);directionsDisplay.setDirections(response)}else{window.alert('Directions request failed due to '+status)}})}
var markerHover=[];$(document).on({mouseenter:function(){var coordinates=$(this).closest(".places-tab").find("#place_id").val();var str=coordinates.replace(/[()]/g,'');var myarr=str.split(",");var mylat=myarr[0];var mylng=myarr[1];var myLatLng=new google.maps.LatLng(mylat,mylng);var marker=new google.maps.Marker({map:map,position:myLatLng,icon:'./img/icons/hoverPin.png'});markerHover.push(marker)},mouseleave:function(){for(var i in markerHover){markerHover[i].setMap(null)}}},".places-tab")}
function clearMarkers(){setMapOnAll(null)}
function clearSearches(){setMapOnAllSearches(null)}
function deleteMarkers(){clearMarkers();markers=[]}
function clearRenderObjects(){for(var i in renderObjects){renderObjects[i].setMap(null)}}})}else{handleLocationError(!1,infoWindow,map.getCenter())}}
